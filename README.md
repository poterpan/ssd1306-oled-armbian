# SSD1306 OLED é¡¯ç¤ºå™¨ - Armbian ç¾ä»£åŒ–ç‰ˆæœ¬

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Platform](https://img.shields.io/badge/Platform-Armbian-orange.svg)](https://www.armbian.com/)
[![Hardware](https://img.shields.io/badge/Hardware-SSD1306-blue.svg)](https://www.adafruit.com/product/326)

é©ç”¨æ–¼ Armbian ç³»çµ±çš„ç¾ä»£åŒ– SSD1306 OLED é¡¯ç¤ºå™¨ç³»çµ±ç›£æ§ç¨‹å¼ã€‚åŸºæ–¼ JSON é…ç½®ç³»çµ±ï¼Œæä¾›å³æ™‚ç³»çµ±è³‡è¨Šé¡¯ç¤ºã€‚

## ğŸ™ è‡´è¬èˆ‡å°ˆæ¡ˆæºèµ·

æœ¬å°ˆæ¡ˆåŸºæ–¼ä»¥ä¸‹å„ªç§€å°ˆæ¡ˆçš„åŸºç¤é€²è¡Œé‡æ§‹å’Œç¾ä»£åŒ–ï¼š

- **[yishunzhikong/SSD1306_OLED_json](https://github.com/yishunzhikong/SSD1306_OLED_json)** - åŸå§‹ JSON é…ç½® OLED é¡¯ç¤ºå°ˆæ¡ˆ (é‡å° OpenWrt)
- **[bearcatl/SSD1306_OLED_json](https://github.com/bearcatl/SSD1306_OLED_json)** - æ“´å±•åŠŸèƒ½åˆ†æ”¯

æ„Ÿè¬å…©ä½åŸä½œè€…çš„å“è¶Šå·¥ä½œï¼Œç‚ºåµŒå…¥å¼ Linux ç³»çµ±çš„ OLED é¡¯ç¤ºæä¾›äº†å„ªç§€çš„ JSON é…ç½®åŒ–è§£æ±ºæ–¹æ¡ˆã€‚æœ¬é‡æ§‹ç‰ˆæœ¬å°ˆé–€é‡å° Armbian ç³»çµ±é€²è¡Œäº†ç¾ä»£åŒ–å’Œç›¸å®¹æ€§æ”¹é€²ã€‚

## ğŸ¯ åŠŸèƒ½ç‰¹è‰²

- **ç¾ä»£å…¼å®¹æ€§**: æ”¯æ´æœ€æ–° Armbian ç™¼è¡Œç‰ˆ
- **ç³»çµ±ç›£æ§**: CPUã€è¨˜æ†¶é«”ã€å­˜å„²ã€ç¶²è·¯ã€æº«åº¦ç›£æ§
- **éˆæ´»é…ç½®**: åŸºæ–¼ JSON çš„é…ç½®ç³»çµ±ï¼Œå¤šç¨®ç¯„æœ¬å¯é¸
- **ä¸€éµå®‰è£**: è‡ªå‹•åŒ–éƒ¨ç½²è…³æœ¬
- **ç¡¬é«”æ”¯æ´**: I2C SSD1306 OLED é¡¯ç¤ºå™¨ (128x64, 128x32)
- **ç¶²è·¯ç„¡é—œ**: æ”¯æ´æœ‰ç·šå’Œç„¡ç·šç¶²è·¯ä»‹é¢

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ä¸€éµéƒ¨ç½²
```bash
# 1. çµ¦è…³æœ¬åŸ·è¡Œæ¬Šé™
chmod +x *.sh

# 2. æ¸¬è©¦ç³»çµ±æŒ‡ä»¤
./test_commands.sh

# 3. è‡ªå‹•éƒ¨ç½² (éœ€è¦ root æ¬Šé™)
sudo ./deploy.sh
```

### æ‰‹å‹•ç·¨è­¯
```bash
# ç·¨è­¯ç¨‹å¼
./build.sh

# æˆ–è€…æ‰‹å‹•ç·¨è­¯
make clean
make
```

### ç³»çµ±éœ€æ±‚
```bash
# å®‰è£å¿…è¦å¥—ä»¶
sudo apt update
sudo apt install i2c-tools build-essential

# å•Ÿç”¨ I2C
sudo armbian-config  # é¸æ“‡ "System" -> "Hardware" -> å•Ÿç”¨ I2C
```

## ğŸ”§ ä¿®å¾©çš„å•é¡Œ

æœ¬å°ˆæ¡ˆè§£æ±ºäº†åŸç‰ˆæœ¬åœ¨ç¾ä»£ Armbian ç³»çµ±ä¸Šçš„é—œéµå…¼å®¹æ€§å•é¡Œï¼š

### 1. ç¶²è·¯æŒ‡ä»¤ç¾ä»£åŒ–
**å•é¡Œ**: åŸç¨‹å¼ä½¿ç”¨ `ifconfig` æŒ‡ä»¤ï¼Œç¾ä»£ Armbian ç³»çµ±é è¨­ä¸åŒ…å«æ­¤æŒ‡ä»¤  
**ä¿®å¾©**: 
- IP åœ°å€ç²å–: æ”¹ç”¨ `ip addr show` æŒ‡ä»¤
- ç¶²è·¯æµé‡çµ±è¨ˆ: æ”¹ç”¨ `/sys/class/net/*/statistics/*` æª”æ¡ˆ

```c
// èˆŠç‰ˆ (ä½¿ç”¨ ifconfig)
"ifconfig eth0 | awk '/RX p/{printf ($5)/1000000000}'"

// æ–°ç‰ˆ (ä½¿ç”¨ /sys/class/net)
"cat /sys/class/net/eth0/statistics/rx_bytes 2>/dev/null | awk '{printf ($1)/1000000000}'"
```

### 2. EMMC å®¹é‡æª¢æ¸¬ä¿®å¾©
**å•é¡Œ**: åŸç¨‹å¼ä½¿ç”¨ `df | awk '/mmcblk/'` ç„¡æ³•æ­£ç¢ºæª¢æ¸¬åˆ° mmcblk2 è¨­å‚™  
**ä¿®å¾©**: æ”¹ç”¨ `df / | tail -1` ç›´æ¥æª¢æ¸¬æ ¹åˆ†å€

### 3. CPU åŠŸèƒ½å„ªåŒ–
**å•é¡Œ**: 
- CPU é »ç‡è·¯å¾‘éŒ¯èª¤ (`cpu[04]` æ‡‰ç‚º `cpu0`)
- top æŒ‡ä»¤è¼¸å‡ºæ ¼å¼è®Šæ›´
- é »ç‡å–®ä½è½‰æ›éŒ¯èª¤

**ä¿®å¾©**:
- CPU é »ç‡: ä½¿ç”¨æ­£ç¢ºè·¯å¾‘ `/sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq`
- CPU ä½¿ç”¨ç‡: æ›´æ–° awk èªæ³•é©é…æ–°çš„ top è¼¸å‡ºæ ¼å¼
- é »ç‡è½‰æ›: ä¿®æ­£ kHz â†’ GHz è½‰æ›

## ğŸ“‹ åŠŸèƒ½å°æ‡‰è¡¨

| åŠŸèƒ½ç·¨è™Ÿ | åŠŸèƒ½æè¿° | ä¿®å¾©ç‹€æ…‹ | èªªæ˜ |
|---------|---------|---------|------|
| 0 | ç²å–æ—¥æœŸ | âœ… æ­£å¸¸ | |
| 1 | ç²å–æ™‚é–“ | âœ… æ­£å¸¸ | |
| 2 | CPUæº«åº¦ | âœ… æ­£å¸¸ | |
| 3 | CPUä½¿ç”¨ç‡ | âœ… å·²ä¿®å¾© | æ›´æ–° top æŒ‡ä»¤æ ¼å¼ |
| 4 | CPUé »ç‡ | âœ… å·²ä¿®å¾© | ä¿®å¾©è·¯å¾‘å’Œå–®ä½è½‰æ› |
| 5 | ç²å–IP | âœ… å·²ä¿®å¾© | æ”¹ç”¨ ip æŒ‡ä»¤ |
| 6-8 | è¨˜æ†¶é«”è³‡è¨Š | âœ… æ­£å¸¸ | ç¸½è¨˜æ†¶é«”ã€ä½¿ç”¨è¨˜æ†¶é«”ã€ä½¿ç”¨ç‡ |
| 9-11 | EMMCè³‡è¨Š | âœ… å·²ä¿®å¾© | ç¸½å®¹é‡ã€ä½¿ç”¨å®¹é‡ã€ä½¿ç”¨ç‡ |
| 20-23 | ç¶²è·¯æµé‡ | âœ… å·²ä¿®å¾© | RX/TX eth0/wlan0 |

## ğŸ”Œ ç¡¬é«”é€£æ¥

| OLED é‡è…³ | é–‹ç™¼æ¿é‡è…³ | èªªæ˜ |
|----------|-----------|------|
| VCC | 3.3V | é›»æºä¾›æ‡‰ |
| GND | GND | æ¥åœ° |
| SDA | GPIO2 (SDA) | I2C è³‡æ–™ç·š |
| SCL | GPIO3 (SCL) | I2C æ™‚é˜ç·š |

### é©—è­‰ç¡¬é«”é€£æ¥
```bash
# æª¢æŸ¥ I2C é€£æ¥
i2cdetect -y 0

# æ‡‰è©²åœ¨åœ°å€ 0x3C (60) é¡¯ç¤ºè¨­å‚™
```

## ğŸ“Š é…ç½®èªªæ˜

### å¿«é€Ÿé…ç½®
ä½¿ç”¨ `config_updated.json` ä½œç‚ºåƒè€ƒï¼ŒåŒ…å«ï¼š
- ç³»çµ±è³‡è¨Šé¡¯ç¤ºé é¢
- ç¶²è·¯è³‡è¨Šé¡¯ç¤ºé é¢  
- å…§å­˜å’Œå­˜å„²è³‡è¨Šé é¢
- æ­£ç¢ºçš„åƒæ•¸é…ç½®

### åŸºæœ¬é…ç½®çµæ§‹
```json
{
    "seting": {
        "pixel": 12864,        // OLEDåˆ†è¾¨ç‡ (128x64 æˆ– 128x32)
        "dev": "/dev/i2c-0",   // I2Cè¨­å‚™è·¯å¾‘
        "addr": 60             // OLED I2Cåœ°å€ (0x3C)
    },
    "page1": {
        "seting": {
            "cycle": 5,        // åˆ·æ–°å‘¨æœŸ (5 * 100ms = 500ms)
            "time": 50,        // é¡¯ç¤ºæ™‚é•· (50 * 100ms = 5ç§’)
            "page": 1          // é é¢é †åº
        },
        "display": [
            // é¡¯ç¤ºå…ƒç´ é…ç½®
        ]
    }
}
```

### ğŸ“– è©³ç´°é…ç½®æ–‡æª”

å¦‚éœ€å®Œæ•´çš„JSONé…ç½®èªæ³•èªªæ˜ã€æ‰€æœ‰é¡¯ç¤ºå…ƒç´ é¡å‹å’Œåƒæ•¸è©³è§£ï¼Œè«‹åƒè€ƒï¼š

**[ğŸ“‹ åŸä½œè€…è©³ç´°é…ç½®æ–‡æª” (README_yishunzhikong.md)](README_yishunzhikong.md)**

è©²æ–‡æª”åŒ…å«ï¼š
- å®Œæ•´çš„JSONèªæ³•èªªæ˜
- æ‰€æœ‰é¡¯ç¤ºå…ƒç´ é¡å‹è©³è§£ï¼ˆé»ã€ç·šã€åœ“ã€çŸ©å½¢ã€ä¸‰è§’å½¢ã€å­—ç¬¦ä¸²ã€æ•¸å­—ç­‰ï¼‰
- å…§ç½®åŸºç¤å…ƒç´ çš„è©³ç´°é…ç½®
- Shellå‘½ä»¤è¿”å›å€¼çš„ä½¿ç”¨æ–¹æ³•
- å„ç¨®å±¬æ€§åƒæ•¸çš„å–å€¼ç¯„åœå’Œèªªæ˜

### å¸¸ç”¨é…ç½®ç¯„ä¾‹

#### é¡¯ç¤ºç³»çµ±æ™‚é–“
```json
{"type": "base", "func": 0, "class": "%H:%M:%S", "x0": 0, "y0": 0, "size": 1, "color": 1, "en": 1}
```

#### é¡¯ç¤ºCPUæº«åº¦
```json
{"type": "base", "func": 1, "x0": 0, "y0": 16, "size": 1, "color": 1, "en": 1}
```

#### é¡¯ç¤ºè‡ªå®šç¾©æ–‡å­—
```json
{"type": "str", "data": "System Info", "x0": 0, "y0": 0, "size": 1, "color": 1, "en": 1}
```

#### åŸ·è¡Œç³»çµ±æŒ‡ä»¤ä¸¦é¡¯ç¤ºçµæœ
```json
{"type": "cmd", "data": "hostname", "x0": 0, "y0": 16, "base": 12, "size": 1, "color": 1, "en": 1}
```

## ğŸ› ï¸ ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬æŒ‡ä»¤
```bash
# å•Ÿå‹•é¡¯ç¤º
ssd_oled &

# ä½¿ç”¨æŒ‡å®šé…ç½®
ssd_oled -c /etc/oled/config.json

# æ¸…é™¤è¢å¹•
ssd_oled -clean

# åœæ­¢ç¨‹å¼
killall ssd_oled
```

### ç¨‹å¼æ§åˆ¶
```bash
# æª¢æŸ¥é‹è¡Œç‹€æ…‹
ps aux | grep ssd_oled

# æª¢æŸ¥ I2C é€£æ¥
i2cdetect -y 0
```

## ğŸ§ª æ¸¬è©¦èˆ‡éƒ¨ç½²

### æ¸¬è©¦ç³»çµ±æŒ‡ä»¤
```bash
./test_commands.sh
```

### æ¸¬è©¦ç¨‹å¼
```bash
# æ¸¬è©¦é…ç½®
./ssd_oled -c config_updated.json

# æ¸…é™¤è¢å¹•
./ssd_oled -clean
```

### è‡ªå‹•å®‰è£
```bash
sudo ./deploy.sh
```

æ‰‹å‹•å®‰è£æ­¥é©Ÿï¼š
1. ç·¨è­¯ç¨‹å¼ï¼š`make clean && make`
2. è¤‡è£½ç¨‹å¼ï¼š`cp ssd_oled /bin/`
3. è¨­å®šæ¬Šé™ï¼š`chmod +x /bin/ssd_oled`
4. å‰µå»ºç›®éŒ„ï¼š`mkdir -p /etc/oled`
5. è¤‡è£½é…ç½®ï¼š`cp config_updated.json /etc/oled/config.json`
6. è¨­å®šè‡ªå•Ÿå‹•ï¼šç·¨è¼¯ `/etc/rc.local`ï¼Œæ·»åŠ  `ssd_oled >/dev/null 1>&2 &`

## ğŸ› æ•…éšœæ’é™¤

### 1. ç¨‹å¼ç„¡æ³•å•Ÿå‹•
```bash
# æª¢æŸ¥ I2C è¨­å‚™
i2cdetect -y 0

# æª¢æŸ¥æ¬Šé™
ls -l /bin/ssd_oled

# ç¢ºä¿ i2c-tools å·²å®‰è£
apt install i2c-tools
```

### 2. é¡¯ç¤ºå…§å®¹éŒ¯èª¤
```bash
# æ¸¬è©¦ç³»çµ±æŒ‡ä»¤
./test_commands.sh

# æŸ¥çœ‹éŒ¯èª¤è¨Šæ¯ (ç§»é™¤é‡å®šå‘)
ssd_oled -c /etc/oled/config.json
```

### 3. EMMC é¡¯ç¤º 0%
```bash
# æª¢æŸ¥æ ¹åˆ†å€
df /

# æ¸¬è©¦æŒ‡ä»¤
df / | tail -1 | awk '{printf ($3)/$2*100}'
```

### 4. ç¶²è·¯è³‡è¨Šç„¡æ³•é¡¯ç¤º
```bash
# æª¢æŸ¥ç¶²è·¯ä»‹é¢
ls /sys/class/net/

# æ¸¬è©¦ IP ç²å–
ip addr show eth0 | grep 'inet '
```

## ğŸ“ é‡è¦æª”æ¡ˆ

| æª”æ¡ˆ | èªªæ˜ |
|------|------|
| `ssd_oled` | ç·¨è­¯å¾Œçš„åŸ·è¡Œæª” |
| `config_updated.json` | ç¾ä»£åŒ–é…ç½®ç¯„ä¾‹ |
| `test_commands.sh` | ç³»çµ±æŒ‡ä»¤æ¸¬è©¦è…³æœ¬ |
| `deploy.sh` | è‡ªå‹•éƒ¨ç½²è…³æœ¬ |
| `build.sh` | ç·¨è­¯è…³æœ¬ |
| `/etc/oled/config.json` | ç³»çµ±é…ç½®æª”æ¡ˆ |
| `/bin/ssd_oled` | ç³»çµ±ç¨‹å¼ä½ç½® |

## ğŸ†š èˆ‡åŸå°ˆæ¡ˆçš„å·®ç•°

### ç›®æ¨™å¹³å°
- **åŸå°ˆæ¡ˆ**: ä¸»è¦é‡å° OpenWrt è·¯ç”±å™¨ç³»çµ±
- **æœ¬å°ˆæ¡ˆ**: å°ˆé–€é‡å° Armbian å–®æ¿é›»è…¦ç³»çµ±

### ç³»çµ±å…¼å®¹æ€§
- **åŸå°ˆæ¡ˆ**: ä½¿ç”¨è¼ƒèˆŠçš„ç³»çµ±æŒ‡ä»¤ï¼Œåœ¨ç¾ä»£ Linux ä¸Šå¯èƒ½å¤±æ•ˆ
- **æœ¬å°ˆæ¡ˆ**: å®Œå…¨ç¾ä»£åŒ–ï¼Œæ”¯æ´æœ€æ–° Armbian ç™¼è¡Œç‰ˆ

### åŠŸèƒ½å¢å¼·
- **åŸå°ˆæ¡ˆ**: åŸºç¤é¡¯ç¤ºåŠŸèƒ½
- **æœ¬å°ˆæ¡ˆ**: å¢åŠ é…ç½®å·¥å…·ã€é©—è­‰å™¨ã€è‡ªå‹•å®‰è£ç­‰

## ğŸ†• æ›´æ–°å…§å®¹

âœ… ä¿®å¾© ifconfig ç›¸å®¹æ€§å•é¡Œ  
âœ… ä¿®å¾© EMMC å®¹é‡æª¢æ¸¬ (0% å•é¡Œ)  
âœ… ä¿®å¾© CPU é »ç‡é¡¯ç¤º  
âœ… æ›´æ–°ç¶²è·¯æµé‡çµ±è¨ˆ  
âœ… ç¨‹å¼é‡å‘½åç‚º ssd_oled  
âœ… æä¾›å®Œæ•´çš„æ¸¬è©¦å’Œéƒ¨ç½²è…³æœ¬  
âœ… ç¾ä»£åŒ–æ‰€æœ‰ç³»çµ±æŒ‡ä»¤

## ğŸ¤ è²¢ç»

æ­¡è¿è²¢ç»ï¼è«‹ï¼š

1. Fork æœ¬å°ˆæ¡ˆ
2. å‰µå»ºåŠŸèƒ½åˆ†æ”¯
3. é€²è¡Œæ›´æ”¹
4. å¦‚é©ç”¨ï¼Œæ·»åŠ æ¸¬è©¦
5. æäº¤ Pull Request

## ğŸ“œ æˆæ¬Š

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Šæ¢æ¬¾ - è©³è¦‹ [LICENSE](LICENSE) æª”æ¡ˆã€‚

## ğŸ”— ç›¸é—œå°ˆæ¡ˆ

- [Armbian](https://www.armbian.com/) - ARM é–‹ç™¼æ¿çš„ Linux ç³»çµ±
- [SSD1306 Library](https://github.com/adafruit/Adafruit_SSD1306) - Arduino SSD1306 é¡¯ç¤ºå™¨åº«
- [cJSON](https://github.com/DaveGamble/cJSON) - JSON è§£æåº«
- [SSD1306 é©…å‹•åº«](https://github.com/deeplyembeddedWP/SSD1306-OLED-display-driver-for-BeagleBone) - BeagleBone SSD1306 é©…å‹•

## ğŸ“ æ”¯æ´

å¦‚æœé‡åˆ°å•é¡Œï¼š
1. å…ˆåŸ·è¡Œ `./test_commands.sh` æª¢æŸ¥ç³»çµ±æŒ‡ä»¤
2. æª¢æŸ¥ I2C é€£æ¥ï¼š`i2cdetect -y 0`
3. æŸ¥çœ‹ç¨‹å¼é‹è¡Œç‹€æ…‹ï¼š`ps aux | grep ssd_oled`
4. ç§»é™¤ `>/dev/null` é‡å®šå‘æŸ¥çœ‹è©³ç´°éŒ¯èª¤è¨Šæ¯

---

**åŸå§‹å°ˆæ¡ˆéˆæ¥**: 
- https://github.com/yishunzhikong/SSD1306_OLED_json
- https://github.com/bearcatl/SSD1306_OLED_json